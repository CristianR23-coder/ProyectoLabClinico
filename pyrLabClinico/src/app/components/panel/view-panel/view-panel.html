<div class="min-w-[320px]">
  @if (loading) {
    <div class="p-4 text-center text-color-secondary">Cargando…</div>
  } @else if (!panel) {
    <div class="p-4 text-center text-red-500">Panel no encontrado.</div>
  } @else {
    <div class="space-y-2">
      <div class="text-xl font-bold">{{ panel.name }}</div>
      <div class="text-color-secondary">{{ panel.description || '—' }}</div>
      <div>
        <p-tag [value]="panel.state" [severity]="panel.state==='ACTIVO' ? 'success' : 'warn'"></p-tag>
      </div>
      <div class="text-xs text-color-secondary">
        <span>Creado: {{ panel.createdAt | date:'dd/MM/yyyy HH:mm' }}</span> ·
        <span>Actualizado: {{ panel.updatedAt | date:'dd/MM/yyyy HH:mm' }}</span>
      </div>
    </div>

    <p-divider></p-divider>

    <h4 class="font-semibold mb-2">Ítems ({{ panel.items.length || 0 }})</h4>
    <p-table [value]="panel.items || []" [tableStyle]="{'min-width':'60rem'}">
      <ng-template pTemplate="header">
        <tr>
          <th>Tipo</th>
          <th>Nombre</th>
          <th>Obligatorio</th>
          <th>Orden</th>
          <th>Notas</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-it>
        <tr>
          <td>{{ it.kind === 'EXAM' ? 'Examen' : 'Parámetro' }}</td>
          <td>{{ nameForItem(it) }}</td>
          <td>{{ it.required ? 'Sí' : 'No' }}</td>
          <td>{{ it.order ?? '—' }}</td>
          <td>{{ it.notes || '—' }}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr><td colspan="5" class="text-center py-6">Sin ítems</td></tr>
      </ng-template>
    </p-table>

    <div class="flex justify-end mt-4">
      <button pButton type="button" label="Cerrar" class="p-button-text !text-red-500 hover:!bg-red-50" (click)="closed.emit()"></button>
    </div>
  }
</div>
