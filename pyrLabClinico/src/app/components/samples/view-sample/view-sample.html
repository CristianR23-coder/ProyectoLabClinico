<div>
  <ng-template pTemplate="header">
  <div class="flex items-center gap-3">
    <span class="font-bold text-xl">Sample</span>
    <span class="text-gray-500" *ngIf="sample?.id">#{{ sample?.id }}</span>
    <p-tag *ngIf="sample?.state" [value]="sample?.state" [severity]="tagSeverity(sample?.state)"></p-tag>
  </div>
  </ng-template>

  <div class="min-w-[320px]">
    <div *ngIf="loading" class="p-4 text-center text-color-secondary">Loading…</div>
    <div *ngIf="!loading && !sample" class="p-4 text-center text-red-500">Muestra no encontrada.</div>

    <ng-container *ngIf="!loading && sample">
      <!-- Cards -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <p-card>
          <ng-template pTemplate="title">Orden</ng-template>
          <div class="space-y-1">
            <div class="font-medium">ORD-{{ sample.orderId }}</div>
            <div class="text-sm text-color-secondary">Paciente: {{ patientName() }}</div>
            <div class="text-sm" *ngIf="order?.doctor?.name">Doctor: {{ order?.doctor?.name }}</div>
          </div>
        </p-card>

        <p-card>
          <ng-template pTemplate="title">Muestra</ng-template>
          <div class="space-y-1 text-sm">
            <div><span class="text-color-secondary">Tipo:</span> {{ specimenLabel(sample.type) }}</div>
            <div><span class="text-color-secondary">Código de barras:</span> {{ sample.barcode || '—' }}</div>
            <div>
              <span class="text-color-secondary">Fecha de toma:</span>
              {{ sample.drawDate ? (sample.drawDate | date:'dd/MM/yyyy HH:mm') : '—' }}
            </div>
          </div>
        </p-card>

        <p-card>
          <ng-template pTemplate="title">Estado</ng-template>
          <div class="space-y-1 text-sm">
            <div>
              <span class="text-color-secondary">Actual:</span>
              <p-tag class="ml-1" [value]="sample.state" [severity]="tagSeverity(sample.state)"></p-tag>
            </div>
          </div>
        </p-card>
      </div>

      <p-divider></p-divider>

      <p-card>
        <ng-template pTemplate="title">Observaciones</ng-template>
        <div class="text-sm whitespace-pre-line">{{ sample.observations || '—' }}</div>
      </p-card>

      <p-divider></p-divider>

      <!-- Footer actions -->
      <div class="flex items-center justify-end gap-2">
        <button pButton type="button" label="Editar" icon="pi pi-pencil" (click)="onEdit()"></button>
        <button pButton type="button" label="Eliminar" icon="pi pi-trash" severity="danger" (click)="onDelete()"></button>
      </div>
    </ng-container>
  </div>
</div>