<form [formGroup]="form" class="space-y-5">
  <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
    <!-- Código -->
    <div>
      <label class="block mb-1 text-sm font-semibold">Código <span class="text-red-500">*</span></label>
      <input pInputText formControlName="code" placeholder="Ej: GLU"
             (blur)="form.patchValue({ code: (form.value.code || '').toUpperCase().trim() })" />
      <small class="p-error" *ngIf="form.get('code')?.invalid && form.get('code')?.touched">
        Requerido (máx. 30).
      </small>
    </div>

    <!-- Nombre -->
    <div class="md:col-span-2">
      <label class="block mb-1 text-sm font-semibold">Nombre <span class="text-red-500">*</span></label>
      <input pInputText formControlName="name" placeholder="Ej: Glucosa (Enzimático)" />
      <small class="p-error" *ngIf="form.get('name')?.invalid && form.get('name')?.touched">
        Requerido (máx. 150).
      </small>
    </div>

    <!-- Método -->
    <div class="md:col-span-3">
      <label class="block mb-1 text-sm font-semibold">Método</label>
      <input pInputText formControlName="method" placeholder="Ej: Enzimático (GOD/POD)" />
      <small class="p-error" *ngIf="form.get('method')?.invalid && form.get('method')?.touched">
        Máx. 120 caracteres.
      </small>
    </div>

    <!-- Tipo de muestra -->
    <div>
      <label class="block mb-1 text-sm font-semibold">Tipo de muestra</label>
      <p-select formControlName="specimenType"
                [options]="specimenOptions"
                optionLabel="label"
                optionValue="value"
                [showClear]="true"
                placeholder="Selecciona tipo"
                appendTo="body">
      </p-select>
    </div>

    <!-- Tiempo de proceso (min) -->
    <div>
      <label class="block mb-1 text-sm font-semibold">Tiempo de proceso (min)</label>
      <p-inputNumber formControlName="processingTimeMin" [showButtons]="true" [useGrouping]="false" [min]="0"></p-inputNumber>
      <small class="p-error" *ngIf="form.get('processingTimeMin')?.invalid && form.get('processingTimeMin')?.touched">
        Debe ser un número ≥ 0 (o vacío).
      </small>
    </div>

    <!-- Precio base -->
    <div>
      <label class="block mb-1 text-sm font-semibold">Precio base</label>
      <p-inputNumber formControlName="priceBase" [showButtons]="true" [useGrouping]="true" [min]="0"></p-inputNumber>
      <small class="p-error" *ngIf="form.get('priceBase')?.invalid && form.get('priceBase')?.touched">
        Requerido y ≥ 0.
      </small>
    </div>

    <!-- Estado -->
    <div>
      <label class="block mb-1 text-sm font-semibold">Estado</label>
      <p-select formControlName="status"
                [options]="statusOptions"
                optionLabel="label"
                optionValue="value"
                placeholder="Estado">
      </p-select>
    </div>
  </div>

  <p-divider></p-divider>

  <!-- Footer -->
  <div class="flex items-center justify-end gap-3">
    <button pButton type="button" class="p-button-text !text-red-500 hover:!bg-red-50" label="Cancelar" (click)="cancel()"></button>
    <button pButton type="button" label="Guardar" icon="pi pi-check" severity="success" (click)="save()"
            [disabled]="form.invalid"></button>
  </div>
</form>
